<!DOCTYPE html>
<html lang="hu">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Bejelentkezés - JavaScript_03</title>
  <link rel="icon" type="image/svg+xml" href="./javascript.svg">

  <!-- Application components -->
  <link rel="stylesheet" 
        href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.8/css/bootstrap.min.css">
  <link rel="stylesheet" 
        href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/7.0.1/css/all.min.css">

  <!-- Styles -->
  <style>
    *:not(input):not(textarea) {
      user-select:none !important;
      outline-style:none !important;
    }
    .cursor-pointer {
      cursor: pointer;
    }
    .btn-form {
      min-width: 150px;
    }
    .fs-xs {
      font-size: 0.6rem;
    }
    .fs-sm {
      font-size: 0.8rem;;
    }
    .shadow-sm-bottom-end {
      box-shadow: 0.3rem 0.3rem 0.3rem 0 rgba(0,0,0,0.3);
    }
    .btn-click-effect:not(.disabled):active {
      animation:btnClickEffect 40ms;
    }
    @keyframes btnClickEffect {
        0% 	{transform:none;}
      50% 	{transform:scale(0.9);}
      100% 	{transform:none;}
    }
    .scale-in {
      animation: scaleIn .6s ease both;
    }
    @keyframes scaleIn {
        0% 	{opacity:0;transform: scale(0); }
      25% 	{opacity:0;transform: scale(0); }
      100% 	{opacity:1;transform: scale(1); }
    }
  </style>

</head>
<body data-bs-theme="dark">

  <!-- Container -->
  <div class="container-fluid">

    <!-- Row -->
    <div class="row vh-100 px-2 position-relative
                justify-content-center align-items-center">

      <!-- Toggle dark/light theme -->
      <div id="toggle-theme"
           class="position-fixed top-0 end-0 
                  w-auto p-3 z-3 cursor-pointer">
        <i class="fa-solid fa-moon fa-lg theme-icon d-none"></i>
        <i class="fa-solid fa-sun fa-lg theme-icon"></i>
      </div>
      
      <!-- Form -->
      <form name="loginForm"
            class="w-auto p-3 border rounded 
                   shadow-sm-bottom-end scale-in">

        <!-- Title -->
        <div class="row my-4 justify-content-center">
          <img src="./javascript.svg" 
               class="mb-3" 
               height="50" 
               alt="logo" 
               loading="lazy">
          <h4 class="text-center">
            <i class="fa-solid fa-right-to-bracket me-1"></i>
            Bejelentkezés
          </h4>
        </div>

        <!-- Email -->
        <div class="mb-4">

          <!-- Label -->
          <label class="form-label fw-bold"
                 for="email">
            <i class="fa-solid fa-star fa-2xs text-danger"></i>
            <i class="fa-solid fa-envelope me-1"></i>
            Email cím:
          </label>

          <!-- Input -->
          <div class="position-relative 
                      d-flex flex-col align-items-center">
            <input type="email"
                   name="email"
                   class="form-control pe-5" 
                   id="email"
                   placeholder="email cím"
                   autocomplete="email"
                   spellcheck="false"
                   required
                   maxlength="253"
                   autofocus>

            <!-- Clear icon -->
            <i class="fa-solid fa-xmark text-primary fa-2xs
                      end-0 me-5 position-absolute cursor-pointer invisible"></i>

            <!-- Check icon -->
            <i class="fa-solid fa-check ms-3 text-success 
                      fw-bold invisible"></i>
          </div>
        </div>

        <!-- Password -->
        <div class="mb-1">

          <!-- Label -->
          <label class="form-label fw-bold"
                 for="password">
            <i class="fa-solid fa-star fa-2xs text-danger"></i>
            <i class="fa-solid fa-key me-1"></i>
            Jelszó:
          </label>

          <!-- Input -->
          <div class="position-relative
                      d-flex flex-col align-items-center">
            <input type="password"
                   name="password" 
                   class="form-control pe-5" 
                   id="password"
                   placeholder="jelszó"
                   autocomplete="current-password"
                   spellcheck="false"
                   required
                   minlength="6"
                   maxlength="20">

            <!-- Clear icon -->
            <i class="fa-solid fa-xmark text-primary fa-2xs
                      end-0 me-5 position-absolute cursor-pointer invisible"></i>

            <!-- Check icon -->
            <i class="fa-solid fa-check ms-3 text-success 
                      fw-bold invisible"></i>
          </div>
        </div>

        <!-- Passwor rule -->
        <div class="mb-2 fs-xs ms-1 me-5 text-break">
          6-20 karakter (legalább egy nagybetűt, egy kisbetűt és egy számot tartalmaz)
        </div>

        <!-- Show/Hide password -->
        <div class="mb-5 d-flex align-items-center">
          <input type="checkbox"
                 name="showPassword" 
                 class="form-check-input m-0" 
                 id="showPassword">
          <label class="form-check-label fs-sm"
                 for="showPassword">
            <i class="fa-solid fa-eye fa-sm ms-2"></i>
            jelszót megjelenít
          </label>
        </div>

        <!-- Buttons -->
        <div class="text-center">

          <!-- Login -->
          <button type="button" 
                  class="btn btn-primary btn-form mx-2 mb-3 
                         shadow-sm-bottom-end btn-click-effect"
                  disabled>
            <i class="fa-solid fa-right-to-bracket me-1"></i>
            Bejelentkezés
          </button>

          <!-- Cancel -->
          <button type="button" 
                  class="btn btn-secondary btn-form mx-2 mb-3 
                         shadow-sm-bottom-end btn-click-effect">
            <i class="fa-solid fa-circle-xmark me-1"></i>
            Mégsem
          </button>
        </div>
      </form>
    </div>
  </div>

  <script>

    // Get elements
    const [inputs, buttons, clearIcons, checkIcons, toggleTheme] = [
      document.querySelectorAll('input'),
      document.querySelectorAll('button'),
      document.querySelectorAll('i.fa-xmark'),
      document.querySelectorAll('i.fa-check'),
      document.querySelector('#toggle-theme')
    ];
    
    // Set methods
    const methods = {

      // Initialize
      init: () => {

        // Set events
        methods.events();
      },

      // Set events
      events: () => {

        // Create for inputs event listener
        inputs.forEach((e, i) => {
          if (i < 2)
                e.addEventListener('input', methods.changed);
          else  e.addEventListener('change', methods.togglePassword); 
        });

        // Create for buttons event listener
        buttons.forEach((e, i) =>
          e.addEventListener('click', methods[i ? 'cancel' : 'login']));

        // Create for clear icon event listener
        clearIcons.forEach(e => {
          e.addEventListener('click', (event) => {
            const element = event.currentTarget,
                  input   = element.parentNode.querySelector('input');
            input.value = "";
            input.focus();
            methods.changed();
          });
        });

        // Create for toggle theme event listener
        toggleTheme.addEventListener('click', () => {

          let theme = document.body.getAttribute('data-bs-theme');
          theme = theme === 'dark' ? 'light' : 'dark';
          document.body.setAttribute('data-bs-theme', theme);

          const themeIcons = toggleTheme.querySelectorAll('i.theme-icon');
          themeIcons.forEach(e => e.classList.toggle('d-none'));
        });
      },

      // Set focus to first input element
      focus: () => {
        setTimeout(() => {inputs[0].focus();}, 150);
      },

      // Check value is valid email
      isEmail: (value) => {
        const RE = /^[^\s@]+@(?:[^\s@]+\.)+[A-Za-z]{2,63}$/;
        return RE.test(value);
      },

      // Check value is valid password
      isPassword: (value) => {
        const RE = /^(?=.*\d)(?=.*[a-z])(?=.*[A-Z]).{6,20}$/;
        return RE.test(value);
      },

      // Set element visibvility
      setVisibility: (element, isVisible) => {
        element.classList[isVisible ? 'remove' : 'add']('invisible');
      },

      // Input changed
      changed: () => {

        // Set is valid helper
        const isValid = [false, false];

        // Each inputs (except show password)
        for(let i=0; i < isValid.length; i++) {

          // Remove leading and trailing spaces
          inputs[i].value = inputs[i].value.trim();

          // Set clear icons visibility
          methods.setVisibility(clearIcons[i], inputs[i].value !== '');

          // Check input value valid
          isValid[i] = i ? methods.isPassword(inputs[i].value) : 
                           methods.isEmail(inputs[i].value);

          // Set checked icon visibility
          methods.setVisibility(checkIcons[i], isValid[i]);
        }

        // Set login button enabled/disabled
        buttons[0].disabled = isValid.includes(false);
      },

      // Show/Hide password
      togglePassword: () => {
        inputs[1].type = inputs[2].checked ? 'text' : 'password';
      },

      // Login
      login: () => {
        alert(`Email cím: ${inputs[0].value}\nJelszó: ${inputs[1].value}`);
        methods.reset();
      },

      // Cancel
      cancel: () => {
        if ((inputs[0].value !== '' ||
             inputs[1].value !== '') &&
             !confirm('Az adatok elvesznek, biztos megszakítja?')) {
          methods.focus();
          return;
        }
        alert('Megszakítva!');
        methods.reset();
      },

      // Reset inputs
      reset: () => {
        for(let i=0; i < inputs.length; i++) {
          if (i < 2)
                inputs[i].value = '';
          else  inputs[i].checked = false;
        }
        methods.togglePassword();
        methods.changed();
        methods.focus();
      }
    };

    // Initialize
    methods.init();

  </script>
</body>
</html>